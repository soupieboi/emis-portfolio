<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="improved.css">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <title>Emi's Portfolio</title>
</head>
<body>

    <nav>
        <div class="logo">
            <img src="newlogo.png" alt="Logo">
        </div>
        <div class="burger">
          <div class="line"></div>
          <div class="line"></div>
          <div class="line"></div>
        </div>
        <ul class="dropdown-menu menu">
            <li><a href="home.html">Home</a></li>
            <li><a href="tools.html">Tools</a></li>
            <li><a href="art.html">Art</a></li>
            <li><a href="skills.html">Skills</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="spotifyplayer.html">Spotify</a></li>
        </ul>
    </nav>

    <h1>Spotify Web Playback SDK Quick Start</h1>
    <br><br>
    <div class="button-container">
        <button id="togglePlay">Pause/Play</button>
        <button id="previousTrack">Previous Track</button>
        <button id="nextTrack">Next Track</button>
    </div>
    <br><br>
    <div id="currentlyPlaying" style="background-color:#d6b9b9; border: 5px solid #5a4f4f; height:auto; width:auto;"></div>

    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script src="main.js"></script>
    <script>
        window.onSpotifyWebPlaybackSDKReady = () => {
        const token = 'BQCmSPlqaBObtCRZ9psD9A-GYcbxw-yJjrPBFv3TViQyCPmrPdlrITqJ4Y9Wdmx4BtuhnV2yM6hQf8bm0-r_dTOuL76xIX-dJN3fNADOt5MRvbSaqcR_aTjSp9oQ_23juqey0Ab5MUyZ-ETN80NtCTEhYKASx7RpyjYQSXvLf0dhmj40nJ6hlY6W6ItnDuQ3Kp9JAQy77czaEvzsyMy2QUAAK3Q9';
        const player = new Spotify.Player({
            name: 'Portfolio Emilia',
            getOAuthToken: cb => { cb(token); },
            volume: 0.5
        });

        player.addListener('ready', ({ device_id }) => {
            console.log('Ready with Device ID', device_id);
        });
    
        // Not Ready
        player.addListener('not_ready', ({ device_id }) => {
            console.log('Device ID has gone offline', device_id);
        });
    
        player.addListener('initialization_error', ({ message }) => {
            console.error('Failed to Initialize', message);
        });
    
        player.addListener('authentication_error', ({ message }) => {
            console.error('Failed to authenticate', message);
        });
    
        player.addListener('account_error', ({ message }) => {
            console.error('Failed to validate Spotify account', message);
        });

        player.addListener('player_state_changed', ({
            track_window: { previous_tracks, next_tracks, current_track },
            context: { MediaMetadata }
        }) => {
            const nextTrackName = next_tracks[0].name;
            const currentlyPlayingDiv = document.getElementById('currentlyPlaying');
            currentlyPlayingDiv.textContent = `Now playing: ${current_track.name} Next track: ${nextTrackName}`;
            console.log('Currently Playing', current_track.name);
            console.log('Next tracks', nextTrackName);
            console.log('Previous tracks', previous_tracks);
          });          

        //Button functions
        document.getElementById('togglePlay').onclick = function() {
            player.togglePlay();
        };
        document.getElementById('previousTrack').onclick = function() {
            player.previousTrack();
        }
        document.getElementById('nextTrack').onclick = function() {
            player.nextTrack();
        }
    
        player.connect()

    }
    </script>
</body>
</html>
